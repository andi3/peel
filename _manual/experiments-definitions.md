---
layout: manual
title: Experiments Definitions
date: 2015-07-07 10:00:00
nav: [ manual, experiments-definitions ]
---

# {{ page.title }}

Experiments are defined in Peel using a Spring [dependency injection](https://en.wikipedia.org/wiki/Dependency_injection) container. The set of beans required to define an experiment represent the system experiments domain introduced in the [Motivation]({{ site.baseurl }}/manual/motivation.html) section.

## Domain Model

The domain model adopted by Peel reflects the basic experiment structure outlined above. A somewhat simplified UML diagram can be seen below.

<div class="row">
    <figure class="large-10 large-centered medium-11 medium-centered small-12 small-centered columns">
        <img src="{{ site.baseurl }}/img/domain_model_uml.svg" title="Peel domain model: UML class diagram" alt="Peel domain model: UML class diagram" /><br />
        <figcaption>Peel domain model: UML class diagram</figcaption>
    </figure>
</div>

### Experiment

The central class in this model is [*Experiment*](https://github.com/stratosphere/peel/blob/master/peel-core/src/main/scala/eu/stratosphere/peel/core/beans/experiment/Experiment.scala). It specifies the experiment *name*, the *command* that executes the experiment application, the number of experiment *runs* (repetitions), the *inputs* required and *outputs* produced by each run, as well as the *runner* system that carries the execution. In addition to that, each experiment defines its own global environment configuration through a value of type *Config* (discussed in more detail in the next section).

### System

The second important class in the model is [*System*](https://github.com/stratosphere/peel/blob/master/peel-core/src/main/scala/eu/stratosphere/peel/core/beans/experiment/Experiment.scala). It has a *name*, a *version*, and a [*Lifespan*](https://github.com/stratosphere/peel/blob/master/peel-core/src/main/scala/eu/stratosphere/peel/core/beans/system/Lifespan.scala) value (one of *Provided*, *Suite*, *Experiment*, or *Run*) which tells Peel when to start and stop the system. In addition to that, a system also maintains a list of system dependencies.

### Experiment Suite

A series of related experiments can be organized in an [*ExperimentSuite*](https://github.com/stratosphere/peel/blob/master/peel-core/src/main/scala/eu/stratosphere/peel/core/beans/experiment/ExperimentSuite.scala). A typical relation between the members of a suite is varying a certain configuration or application parameter, e.g., the number of hosts for a scale-out experiment, or the predicate literal for a select query with varying selectivity.

### Data Sets

Experiments typically depend on some kind of input data, represented as abstract DataSet elements associated with a particular FileSystem in our model. The following types are currently supported:

* [*CopiedDataSet*](https://github.com/stratosphere/peel/blob/master/peel-core/src/main/scala/eu/stratosphere/peel/core/beans/data/CopiedDataSet.scala) - used for static data copied into the target *FileSystem*;
* [*GeneratedDataSet*](https://github.com/stratosphere/peel/blob/master/peel-core/src/main/scala/eu/stratosphere/peel/core/beans/data/GeneratedDataSet.scala) - used for data generated by a Job into the target *FileSystem*;

## Dependency Graph

An experiment suite induces a dependency graph based on the following rules:

* An *ExperimentSuite* depends on its experiments;
* An *Experiment* depends on its *runner* and its *inputs*;
* A *DataSet* depends on its *FileSystem*;
* A *System* depends on its *dependencies*.

This dependency graph is used to determine which systems need to be running at various points in the lifecycle of an experiment.

## Supported Systems

Peel supports the following systems out of the box.

| System           | Version        | System bean ID  |
| ---------------- | ----------------------------------
| HDFS             | 1.2.1          | hdfs-1.2.1      |
| HDFS             | 2.4.1          | hdfs-2.4.1      |
| Flink            | 0.8.0          | flink-0.8.0     |
| Flink            | 0.8.1          | flink-0.8.1     |
| Flink            | 0.9.0          | flink-0.9.0     |
| Flink            | 0.10-SNAPSHOT  | flink-0.10      |
| MapReduce        | 1.2.1          | mapred-1.2.1    |
| MapReduce        | 2.4.1          | mapred-2.4.1    |
| Spark            | 1.3.1          | spark-1.3.1     |
| Spark            | 1.4.0          | spark-1.4.0     |
| Zookeeper        | 3.4.5          | zookeeper-3.4.5 |

Each system bean ships with [a default configuration entry](https://github.com/stratosphere/peel/tree/master/peel-extensions/src/main/resources) which sets values suitable for running experiments on your local machine. Browse the corresponding [*peel-extensions*](https://github.com/stratosphere/peel/tree/master/peel-extensions/src/main/scala/eu/stratosphere/peel/extensions) packages to see what other beans are implemented for each system.

If you want to add support for another system, use one of the existing implementations as a starting point. [Contributions are welcome](https://github.com/stratosphere/peel/pulls)!

## Example

[TODO: Example]